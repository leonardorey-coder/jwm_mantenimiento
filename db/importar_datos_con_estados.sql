-- Script para importar datos de finest_mant_cuartos.sql a PostgreSQL
-- Con estados aleatorios para los cuartos

-- Insertar edificios
INSERT INTO edificios (id, nombre, descripcion) VALUES
(1, 'Alfa', 'Edificio Alfa'),
(2, 'Bravo', 'Edificio Bravo'),
(3, 'Charly', 'Edificio Charly'),
(4, 'Eco', 'Edificio Eco'),
(5, 'Fox', 'Edificio Fox'),
(6, 'Casa Maat', 'Edificio Casa Maat')
ON CONFLICT (nombre) DO NOTHING;

-- Ajustar secuencia de edificios
SELECT setval('edificios_id_seq', (SELECT MAX(id) FROM edificios));

-- Función para generar estado aleatorio
CREATE OR REPLACE FUNCTION estado_aleatorio() RETURNS VARCHAR AS $$
DECLARE
    estados VARCHAR[] := ARRAY['disponible', 'ocupado', 'mantenimiento', 'fuera_servicio'];
    random_index INTEGER;
BEGIN
    random_index := floor(random() * array_length(estados, 1) + 1)::INTEGER;
    RETURN estados[random_index];
END;
$$ LANGUAGE plpgsql;

-- Insertar cuartos con estados aleatorios
INSERT INTO cuartos (id, numero, edificio_id, descripcion, estado) VALUES
(1, 'A101', 1, NULL, estado_aleatorio()),
(2, 'A102', 1, NULL, estado_aleatorio()),
(3, 'A103', 1, '17/7/2024', estado_aleatorio()),
(4, 'A104', 1, NULL, estado_aleatorio()),
(5, 'A105', 1, NULL, estado_aleatorio()),
(6, 'A106', 1, NULL, estado_aleatorio()),
(7, 'S-A201', 1, NULL, estado_aleatorio()),
(8, 'A202', 1, NULL, estado_aleatorio()),
(9, 'A203', 1, NULL, estado_aleatorio()),
(10, 'A204', 1, NULL, estado_aleatorio()),
(11, 'A205', 1, NULL, estado_aleatorio()),
(12, 'A206', 1, NULL, estado_aleatorio()),
(13, 'A207', 1, NULL, estado_aleatorio()),
(14, 'S-A208', 1, NULL, estado_aleatorio()),
(15, 'A302', 1, NULL, estado_aleatorio()),
(16, 'A303', 1, NULL, estado_aleatorio()),
(17, 'A304', 1, NULL, estado_aleatorio()),
(18, 'A305', 1, NULL, estado_aleatorio()),
(19, 'A306', 1, NULL, estado_aleatorio()),
(20, 'S-A301', 1, NULL, estado_aleatorio()),
(21, 'S-A307', 1, NULL, estado_aleatorio()),
(22, 'A401', 1, NULL, estado_aleatorio()),
(23, 'A402', 1, NULL, estado_aleatorio()),
(24, 'A403', 1, NULL, estado_aleatorio()),
(25, 'A404', 1, NULL, estado_aleatorio()),
(26, 'A405', 1, NULL, estado_aleatorio()),
(27, 'A406', 1, NULL, estado_aleatorio()),
(28, 'S-A401', 1, NULL, estado_aleatorio()),
(29, 'S-A407', 1, NULL, estado_aleatorio()),
(30, 'A501', 1, NULL, estado_aleatorio()),
(31, 'A502', 1, NULL, estado_aleatorio()),
(32, 'A503', 1, NULL, estado_aleatorio()),
(33, 'A504', 1, NULL, estado_aleatorio()),
(34, 'A505', 1, NULL, estado_aleatorio()),
(35, 'A506', 1, NULL, estado_aleatorio()),
(36, 'S-A501', 1, NULL, estado_aleatorio()),
(37, 'S-A507', 1, NULL, estado_aleatorio()),
(38, 'B101', 2, NULL, estado_aleatorio()),
(39, 'B102', 2, NULL, estado_aleatorio()),
(40, 'B103', 2, NULL, estado_aleatorio()),
(41, 'B104', 2, NULL, estado_aleatorio()),
(42, 'B105', 2, '10/9/2024', estado_aleatorio()),
(43, 'B106', 2, NULL, estado_aleatorio()),
(44, 'B107', 2, NULL, estado_aleatorio()),
(45, 'B108', 2, NULL, estado_aleatorio()),
(46, 'B109', 2, NULL, estado_aleatorio()),
(47, 'B110', 2, NULL, estado_aleatorio()),
(48, 'B111', 2, NULL, estado_aleatorio()),
(49, 'B112', 2, NULL, estado_aleatorio()),
(50, 'B113', 2, NULL, estado_aleatorio()),
(51, 'B114', 2, NULL, estado_aleatorio()),
(52, 'B115', 2, NULL, estado_aleatorio()),
(53, 'B201', 2, NULL, estado_aleatorio()),
(54, 'B202', 2, NULL, estado_aleatorio()),
(55, 'B203', 2, '27/10/2024', estado_aleatorio()),
(56, 'B204', 2, NULL, estado_aleatorio()),
(57, 'B205', 2, NULL, estado_aleatorio()),
(58, 'B206', 2, NULL, estado_aleatorio()),
(59, 'B207', 2, NULL, estado_aleatorio()),
(60, 'B208', 2, NULL, estado_aleatorio()),
(61, 'B210', 2, NULL, estado_aleatorio()),
(62, 'B211', 2, NULL, estado_aleatorio()),
(63, 'B212', 2, NULL, estado_aleatorio()),
(64, 'B213', 2, NULL, estado_aleatorio()),
(65, 'B214', 2, NULL, estado_aleatorio()),
(66, 'B215', 2, NULL, estado_aleatorio()),
(67, 'B301', 2, NULL, estado_aleatorio()),
(68, 'B302', 2, NULL, estado_aleatorio()),
(69, 'B303', 2, NULL, estado_aleatorio()),
(70, 'B304', 2, NULL, estado_aleatorio()),
(71, 'B305', 2, NULL, estado_aleatorio()),
(72, 'B306', 2, NULL, estado_aleatorio()),
(73, 'B308', 2, NULL, estado_aleatorio()),
(74, 'B309', 2, NULL, estado_aleatorio()),
(75, 'B310', 2, NULL, estado_aleatorio()),
(76, 'B311', 2, NULL, estado_aleatorio()),
(77, 'B312', 2, NULL, estado_aleatorio()),
(78, 'B313', 2, NULL, estado_aleatorio()),
(79, 'B315', 2, NULL, estado_aleatorio()),
(80, 'B401', 2, NULL, estado_aleatorio()),
(81, 'B402', 2, NULL, estado_aleatorio()),
(82, 'B403', 2, NULL, estado_aleatorio()),
(83, 'B404', 2, NULL, estado_aleatorio()),
(84, 'B405', 2, NULL, estado_aleatorio()),
(85, 'B406', 2, NULL, estado_aleatorio()),
(86, 'B407', 2, NULL, estado_aleatorio()),
(87, 'B408', 2, NULL, estado_aleatorio()),
(88, 'B409', 2, NULL, estado_aleatorio()),
(89, 'B410', 2, NULL, estado_aleatorio()),
(90, 'B411', 2, NULL, estado_aleatorio()),
(91, 'B412', 2, NULL, estado_aleatorio()),
(92, 'B413', 2, NULL, estado_aleatorio()),
(93, 'B414', 2, NULL, estado_aleatorio()),
(94, 'B415', 2, NULL, estado_aleatorio()),
(95, 'C101', 3, NULL, estado_aleatorio()),
(96, 'C102', 3, NULL, estado_aleatorio()),
(97, 'C103', 3, NULL, estado_aleatorio()),
(98, 'C104', 3, NULL, estado_aleatorio()),
(99, 'C105', 3, NULL, estado_aleatorio()),
(100, 'C106', 3, NULL, estado_aleatorio()),
(101, 'C107', 3, NULL, estado_aleatorio()),
(102, 'C108', 3, NULL, estado_aleatorio()),
(103, 'C109', 3, NULL, estado_aleatorio()),
(104, 'C110', 3, NULL, estado_aleatorio()),
(105, 'C111', 3, NULL, estado_aleatorio()),
(106, 'C112', 3, '11/12/2024', estado_aleatorio()),
(107, 'C113', 3, NULL, estado_aleatorio()),
(108, 'C201', 3, NULL, estado_aleatorio()),
(109, 'C202', 3, NULL, estado_aleatorio()),
(110, 'C203', 3, NULL, estado_aleatorio()),
(111, 'C204', 3, NULL, estado_aleatorio()),
(112, 'C205', 3, NULL, estado_aleatorio()),
(113, 'C206', 3, NULL, estado_aleatorio()),
(114, 'C207', 3, NULL, estado_aleatorio()),
(115, 'C208', 3, NULL, estado_aleatorio()),
(116, 'C209', 3, NULL, estado_aleatorio()),
(117, 'C210', 3, NULL, estado_aleatorio()),
(118, 'C211', 3, NULL, estado_aleatorio()),
(119, 'C212', 3, NULL, estado_aleatorio()),
(120, 'C213', 3, NULL, estado_aleatorio()),
(121, 'C214', 3, NULL, estado_aleatorio()),
(122, 'C301', 3, NULL, estado_aleatorio()),
(123, 'C302', 3, NULL, estado_aleatorio()),
(124, 'C303', 3, NULL, estado_aleatorio()),
(125, 'C304', 3, NULL, estado_aleatorio()),
(126, 'C305', 3, NULL, estado_aleatorio()),
(127, 'C306', 3, NULL, estado_aleatorio()),
(128, 'C307', 3, NULL, estado_aleatorio()),
(129, 'C308', 3, NULL, estado_aleatorio()),
(130, 'C309', 3, NULL, estado_aleatorio()),
(131, 'C310', 3, NULL, estado_aleatorio()),
(132, 'C311', 3, NULL, estado_aleatorio()),
(133, 'C312', 3, NULL, estado_aleatorio()),
(134, 'C313', 3, NULL, estado_aleatorio()),
(135, 'C314', 3, NULL, estado_aleatorio()),
(136, 'C401', 3, NULL, estado_aleatorio()),
(137, 'C402', 3, NULL, estado_aleatorio()),
(138, 'C403', 3, NULL, estado_aleatorio()),
(139, 'C404', 3, NULL, estado_aleatorio()),
(140, 'C405', 3, NULL, estado_aleatorio()),
(141, 'C406', 3, NULL, estado_aleatorio()),
(142, 'C407', 3, NULL, estado_aleatorio()),
(143, 'C408', 3, NULL, estado_aleatorio()),
(144, 'C409', 3, NULL, estado_aleatorio()),
(145, 'C410', 3, NULL, estado_aleatorio()),
(146, 'C411', 3, NULL, estado_aleatorio()),
(147, 'C412', 3, NULL, estado_aleatorio()),
(148, 'C413', 3, NULL, estado_aleatorio()),
(149, 'C414', 3, NULL, estado_aleatorio()),
(150, 'E101', 4, NULL, estado_aleatorio()),
(151, 'E102', 4, NULL, estado_aleatorio()),
(152, 'E103', 4, NULL, estado_aleatorio()),
(153, 'E104', 4, NULL, estado_aleatorio()),
(154, 'E105', 4, NULL, estado_aleatorio()),
(155, 'E106', 4, NULL, estado_aleatorio()),
(156, 'E107', 4, '25/07/2024', estado_aleatorio()),
(157, 'E108', 4, NULL, estado_aleatorio()),
(158, 'E109', 4, NULL, estado_aleatorio()),
(159, 'E110', 4, '22/07/2024', estado_aleatorio()),
(160, 'E111', 4, NULL, estado_aleatorio()),
(161, 'E112', 4, NULL, estado_aleatorio()),
(162, 'E113', 4, NULL, estado_aleatorio()),
(163, 'E201', 4, NULL, estado_aleatorio()),
(164, 'E202', 4, NULL, estado_aleatorio()),
(165, 'E203', 4, NULL, estado_aleatorio()),
(166, 'E204', 4, NULL, estado_aleatorio()),
(167, 'E205', 4, NULL, estado_aleatorio()),
(168, 'E206', 4, NULL, estado_aleatorio()),
(169, 'E207', 4, NULL, estado_aleatorio()),
(170, 'E208', 4, NULL, estado_aleatorio()),
(171, 'E209', 4, NULL, estado_aleatorio()),
(172, 'E210', 4, NULL, estado_aleatorio()),
(173, 'E211', 4, NULL, estado_aleatorio()),
(174, 'E212', 4, NULL, estado_aleatorio()),
(175, 'E301', 4, NULL, estado_aleatorio()),
(176, 'E302', 4, NULL, estado_aleatorio()),
(177, 'E303', 4, NULL, estado_aleatorio()),
(178, 'E304', 4, NULL, estado_aleatorio()),
(179, 'E305', 4, NULL, estado_aleatorio()),
(180, 'E306', 4, NULL, estado_aleatorio()),
(181, 'E307', 4, NULL, estado_aleatorio()),
(182, 'E308', 4, NULL, estado_aleatorio()),
(183, 'E309', 4, NULL, estado_aleatorio()),
(184, 'E310', 4, NULL, estado_aleatorio()),
(185, 'E311', 4, NULL, estado_aleatorio()),
(186, 'E312', 4, NULL, estado_aleatorio()),
(187, 'E401', 4, NULL, estado_aleatorio()),
(188, 'E402', 4, NULL, estado_aleatorio()),
(189, 'E403', 4, NULL, estado_aleatorio()),
(190, 'E404', 4, NULL, estado_aleatorio()),
(191, 'E405', 4, NULL, estado_aleatorio()),
(192, 'E406', 4, NULL, estado_aleatorio()),
(193, 'E407', 4, NULL, estado_aleatorio()),
(194, 'E408', 4, NULL, estado_aleatorio()),
(195, 'E409', 4, NULL, estado_aleatorio()),
(196, 'E410', 4, NULL, estado_aleatorio()),
(197, 'E411', 4, NULL, estado_aleatorio()),
(198, 'E412', 4, NULL, estado_aleatorio()),
(199, 'F101', 5, NULL, estado_aleatorio()),
(200, 'F102', 5, NULL, estado_aleatorio()),
(201, 'F103', 5, NULL, estado_aleatorio()),
(202, 'F104', 5, NULL, estado_aleatorio()),
(203, 'F105', 5, '16/12/2024', estado_aleatorio()),
(204, 'F106', 5, '19/12/2024', estado_aleatorio()),
(205, 'F107', 5, '05/10/2024', estado_aleatorio()),
(206, 'F108', 5, NULL, estado_aleatorio()),
(207, 'F109', 5, NULL, estado_aleatorio()),
(208, 'F110', 5, NULL, estado_aleatorio()),
(209, 'F111', 5, NULL, estado_aleatorio()),
(210, 'F112', 5, NULL, estado_aleatorio()),
(211, 'F113', 5, '29/10/2024', estado_aleatorio()),
(212, 'S-F114', 5, NULL, estado_aleatorio()),
(213, 'F201', 5, NULL, estado_aleatorio()),
(214, 'F202', 5, NULL, estado_aleatorio()),
(215, 'F203', 5, NULL, estado_aleatorio()),
(216, 'F204', 5, NULL, estado_aleatorio()),
(217, 'F205', 5, NULL, estado_aleatorio()),
(218, 'F206', 5, NULL, estado_aleatorio()),
(219, 'F207', 5, NULL, estado_aleatorio()),
(220, 'F208', 5, NULL, estado_aleatorio()),
(221, 'F209', 5, NULL, estado_aleatorio()),
(222, 'F210', 5, NULL, estado_aleatorio()),
(223, 'F211', 5, '23/11/2024', estado_aleatorio()),
(224, 'F212', 5, NULL, estado_aleatorio()),
(225, 'F213', 5, NULL, estado_aleatorio()),
(226, 'S-F214', 5, NULL, estado_aleatorio()),
(227, 'F301', 5, NULL, estado_aleatorio()),
(228, 'F302', 5, NULL, estado_aleatorio()),
(229, 'F303', 5, NULL, estado_aleatorio()),
(230, 'F304', 5, NULL, estado_aleatorio()),
(231, 'F305', 5, NULL, estado_aleatorio()),
(232, 'F306', 5, NULL, estado_aleatorio()),
(233, 'F307', 5, NULL, estado_aleatorio()),
(234, 'F308', 5, NULL, estado_aleatorio()),
(235, 'F309', 5, NULL, estado_aleatorio()),
(236, 'F310', 5, NULL, estado_aleatorio()),
(237, 'F311', 5, NULL, estado_aleatorio()),
(238, 'F312', 5, NULL, estado_aleatorio()),
(239, 'F313', 5, NULL, estado_aleatorio()),
(240, 'S-F314', 5, NULL, estado_aleatorio()),
(241, 'F401', 5, NULL, estado_aleatorio()),
(242, 'F402', 5, NULL, estado_aleatorio()),
(243, 'F403', 5, NULL, estado_aleatorio()),
(244, 'F404', 5, NULL, estado_aleatorio()),
(245, 'F405', 5, NULL, estado_aleatorio()),
(246, 'F406', 5, NULL, estado_aleatorio()),
(247, 'F407', 5, NULL, estado_aleatorio()),
(248, 'F408', 5, NULL, estado_aleatorio()),
(249, 'F409', 5, NULL, estado_aleatorio()),
(250, 'F410', 5, NULL, estado_aleatorio()),
(251, 'F411', 5, NULL, estado_aleatorio()),
(252, 'F412', 5, NULL, estado_aleatorio()),
(253, 'F413', 5, NULL, estado_aleatorio()),
(254, 'S-F414', 5, NULL, estado_aleatorio()),
(255, 'G101', 6, '12/06/2024', estado_aleatorio()),
(256, 'G102', 6, '20/07/2024', estado_aleatorio()),
(257, 'G103', 6, '13/06/2024', estado_aleatorio()),
(258, 'G104', 6, '04/09/2024', estado_aleatorio()),
(259, 'G105', 6, '05/07/2024', estado_aleatorio()),
(260, 'G106', 6, '02/07/2024', estado_aleatorio()),
(261, 'G107', 6, '05/09/2024', estado_aleatorio()),
(262, 'G108', 6, '10/07/2024', estado_aleatorio()),
(263, 'G109', 6, '13/06/2024', estado_aleatorio()),
(264, 'G110', 6, '17/06/2024', estado_aleatorio()),
(265, 'S-G111', 6, '27/08/2024', estado_aleatorio()),
(266, 'G201', 6, '18/08/2024', estado_aleatorio()),
(267, 'G202', 6, '10/10/2024', estado_aleatorio()),
(268, 'G203', 6, '16/08/2024', estado_aleatorio()),
(269, 'G204', 6, '15/08/2024', estado_aleatorio()),
(270, 'S-G408', 6, '01/11/2024', estado_aleatorio()),
(271, 'G206', 6, '12/09/2024', estado_aleatorio()),
(272, 'G207', 6, '08/11/2024', estado_aleatorio()),
(273, 'G208', 6, '28/11/2024', estado_aleatorio()),
(274, 'G209', 6, '16/01/2025', estado_aleatorio()),
(275, 'G210', 6, '23/01/2025', estado_aleatorio()),
(276, 'G211', 6, '03/12/2024', estado_aleatorio()),
(277, 'G212', 6, NULL, estado_aleatorio()),
(278, 'S-G213', 6, '02/08/2024', estado_aleatorio()),
(279, 'G301', 6, '03/02/2025', estado_aleatorio()),
(280, 'G302', 6, '22/02/2025', estado_aleatorio()),
(281, 'G303', 6, NULL, estado_aleatorio()),
(282, 'G304', 6, '04/09/2024', estado_aleatorio()),
(283, 'G305', 6, '05/07/2024', estado_aleatorio()),
(284, 'G306', 6, '05/09/2024', estado_aleatorio()),
(285, 'G308', 6, '15/08/2024', estado_aleatorio()),
(286, 'G309', 6, NULL, estado_aleatorio()),
(287, 'G310', 6, NULL, estado_aleatorio()),
(288, 'G401', 6, '02/07/2024', estado_aleatorio()),
(289, 'G402', 6, '17/06/2024', estado_aleatorio()),
(290, 'G403', 6, '13/06/2024', estado_aleatorio()),
(291, 'G404', 6, '07/07/2024', estado_aleatorio()),
(292, 'G405', 6, '27/08/2024', estado_aleatorio()),
(293, 'G406', 6, '16/08/2024', estado_aleatorio()),
(294, 'G407', 6, '15/08/2024', estado_aleatorio()),
(295, 'G408', 6, '28/11/2024', estado_aleatorio()),
(296, 'G409', 6, NULL, estado_aleatorio()),
(297, 'G501', 6, '08/11/2024', estado_aleatorio()),
(298, 'G502', 6, NULL, estado_aleatorio()),
(299, 'G503', 6, '03/12/2024', estado_aleatorio()),
(300, 'G504', 6, NULL, estado_aleatorio()),
(301, 'S-G505', 6, '03/12/2024', estado_aleatorio())
ON CONFLICT (numero, edificio_id) DO NOTHING;

-- Ajustar secuencia de cuartos
SELECT setval('cuartos_id_seq', (SELECT MAX(id) FROM cuartos));

-- Insertar mantenimientos de ejemplo
INSERT INTO mantenimientos (id, cuarto_id, descripcion, tipo, hora, dia_alerta, fecha_creacion) VALUES
(1, 3, 'FOCOS FUNDIDOS', 'normal', NULL, NULL, '2025-04-22 19:31:45'),
(2, 1, 'Cerrar valvulas', 'normal', NULL, NULL, '2025-04-22 20:15:27'),
(3, 1, 'Foco fundido', 'normal', NULL, NULL, '2025-04-22 20:16:17'),
(4, 4, 'Foco fundido', 'normal', NULL, NULL, '2025-04-22 20:16:36')
ON CONFLICT DO NOTHING;

-- Ajustar secuencia de mantenimientos
SELECT setval('mantenimientos_id_seq', (SELECT COALESCE(MAX(id), 0) + 1 FROM mantenimientos));

-- Mostrar resumen
SELECT 
    estado,
    COUNT(*) as cantidad,
    ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM cuartos), 2) as porcentaje
FROM cuartos
GROUP BY estado
ORDER BY cantidad DESC;

-- Limpiar función temporal
DROP FUNCTION IF EXISTS estado_aleatorio();

COMMIT;

